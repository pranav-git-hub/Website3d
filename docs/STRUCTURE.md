# Project structure (code + runtime flow)

## High-level architecture

- **Build tool**: Vite (`vite.config.mjs` sets `base` for GitHub Pages; can be overridden by `VITE_BASE`).
- **Runtime**: Vanilla TypeScript modules, no framework.
- **Rendering**: Three.js scene rendered into `#darkstar-container` inside the landing section.
- **Landing UI effects**:
  - Parallax: DOM layers transformed with a spring-smoothed scroll progress.
  - Flip words: DOM text replaced/animated on a timer.
- **Tooling**: ESLint (`eslint.config.mjs`) + Prettier (`.prettierrc.json`).

## Directory tree (source-of-truth)

```
Website3d/
  .prettierrc.json
  eslint.config.mjs
  index.html
  package.json
  vite.config.mjs
  tsconfig.json
  readme.txt
  docs/
    FILE_MAP.md
    STRUCTURE.md
  src/
    main.ts
    style.css
    vite-env.d.ts
    typescript.svg
    app/
      Camera.ts
      Controls.ts
      Lights.ts
      observeElementSize.ts
      Renderer.ts
      threeDispose.ts
    landing/
      parallax.ts
      flipWords.ts
    models/
      SuperHornet.ts
    utils/
      mobileCheck.ts
  public/
    assets/
      DarkStar.glb
      DarkStarSmall.glb
      intro_bg.PNG
      sky.jpg
      planets.png
      mountain-1.png
      mountain-2.png
      mountain-3.png
    models/
      astronaut.glb
    vite.svg
  dist/               (generated)
  node_modules/       (generated)
```

Notes:
- `dist/` is generated by `npm run build` and is what `npm run deploy` publishes.
- `node_modules/` is generated by `npm install`.
- `src/app/SceneManager.ts` and `src/models/loadModel.ts` no longer exist (they were placeholders in an earlier iteration).

## Runtime flow (what runs on page load)

1. **`index.html` loads `src/main.ts`**
   - Also defines the DOM elements the effects attach to:
     - `#darkstar-container` for the Three.js canvas.
     - `[data-parallax-root]` and `[data-parallax-layer]` for parallax layers.
     - `[data-flip-words]` for the flip-words headline.

2. **`src/main.ts` bootstraps everything**
   - Sets `--site-bg` using `import.meta.env.BASE_URL` so `intro_bg.PNG` resolves under a non-root base (GitHub Pages).
   - Creates a Three.js `scene`, `camera`, `renderer`.
   - Adds lights from `createLights()`.
   - Loads the DarkStar model via `loadSuperHornet({ scene, container, baseUrl, useSmall })`.
   - Starts landing effects:
     - `initLandingParallax(...)` (scroll + RAF driven)
     - `initFlipWords(...)` (timer driven)
   - Starts the main RAF loop:
     - calls `hornet?.update()` each frame (updates model rotation/lean)
     - calls `renderer.render(scene, camera)`
   - Registers a `dispose()` function as `window.__disposeWebsite3d` to stop RAF, remove listeners, remove the canvas, and dispose scene GPU resources.

3. **Per-module responsibilities**
   - **`src/app/*`**: low-level Three.js setup (renderer/camera/lights) and input-driven model updates (`Controls.ts`).
   - **`src/models/SuperHornet.ts`**: loads the GLB and returns an update function connected to input.
   - **`src/landing/parallax.ts`**: DOM parallax effect (scroll listeners + RAF updates).
   - **`src/landing/flipWords.ts`**: DOM text swap/animation (setTimeout loop).


