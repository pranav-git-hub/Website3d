# File map (what each file does)

This repo is a **Vite + TypeScript + Three.js** site that renders a 3D model (“DarkStar”) on the landing section, with **parallax background** and a **flip-words** text animation.

## Root

- **`index.html`**: Main HTML document. Defines the top nav, the landing section (parallax layers + `#darkstar-container` canvas host), the About section, and loads the app entry via `<script type="module" src="/src/main.ts">`.
- **`package.json`**: Project metadata and scripts:
  - `dev`: run Vite dev server
  - `typecheck`: TypeScript typecheck (`tsc --noEmit`)
  - `lint`: ESLint
  - `format`: Prettier
  - `build`: typecheck + Vite build
  - `deploy`: publish `dist/` to GitHub Pages via `gh-pages`
  Declares dependencies (`three`, `three-stdlib`) and tooling dev deps (`vite`, `typescript`, `eslint`, `prettier`, etc).
- **`package-lock.json`**: NPM lockfile (exact dependency versions).
- **`.prettierrc.json`**: Prettier formatting rules (quotes, semicolons, print width, trailing commas).
- **`eslint.config.mjs`**: ESLint flat config for JS/TS, with Prettier compatibility and ignores for `dist/` and `node_modules/`.
- **`vite.config.mjs`**: Vite config; sets `base` for correct asset paths on GitHub Pages. Supports override via `VITE_BASE` env var (e.g. `VITE_BASE="/"`).
- **`tsconfig.json`**: TypeScript compiler settings (strict mode, bundler module resolution, noEmit, etc.).
- **`readme.txt`**: A short notes file describing the intended `src/` structure (not guaranteed to be fully up to date).
- **`dist/`**: Build output (generated by `npm run build`). This is what gets deployed via `npm run deploy` (`gh-pages -d dist`).
- **`node_modules/`**: Installed dependencies (generated; not source code).

## `src/` (application source)

### Entry + global styles

- **`src/main.ts`**: App entry point and top-level orchestration:
  - Sets CSS var `--site-bg` using `import.meta.env.BASE_URL` so the background image works under a GitHub Pages base path.
  - Creates the Three.js `scene`, camera, renderer, lights.
  - Loads the “DarkStar” model via `loadSuperHornet({ scene, container, baseUrl, useSmall })`.
  - Initializes landing effects: `initLandingParallax(...)` and `initFlipWords(...)`.
  - Runs a requestAnimationFrame loop to update model rotation/lean and render the scene (skips work while the document is hidden).
  - Implements teardown via a `dispose()` function (cancels RAF, removes listeners, disposes WebGL + scene resources) and exposes it as `window.__disposeWebsite3d`.
- **`src/style.css`**: Global styles for layout and visuals:
  - Fixed top nav.
  - Landing section layout (parallax background layers + canvas overlay).
  - Hero typography and flip-word animation CSS.
  - About section styling.
  - Uses `--site-bg` for the page background image (set from `src/main.ts`).

### `src/app/` (Three.js “engine” helpers)

- **`src/app/observeElementSize.ts`**: Small helper around `ResizeObserver` to watch an element and emit width/height changes.
- **`src/app/Camera.ts`**: Creates a `THREE.PerspectiveCamera` sized to a specific container element. Uses `observeElementSize(...)` to keep aspect/projection updated. Returns `{ camera, dispose }`.
- **`src/app/Renderer.ts`**: Creates a `THREE.WebGLRenderer` sized to a container element. Uses `observeElementSize(...)` to resize the renderer when the host container changes size. Returns `{ renderer, dispose }`.
- **`src/app/Lights.ts`**: Creates the lighting setup (ambient + key/fill directional lights).
- **`src/app/Controls.ts`**: Input-driven model motion:
  - Uses `pointermove` on a specific element (the canvas host container) to compute target rotations.
  - Applies smoothing + clamps rotation ranges each frame.
  - On desktop also applies a “lean” effect by shifting model position.
  - Exposes `createPointerRotationController({ element, model, ... })` which returns `{ update, dispose }` for the render loop and cleanup.
- **`src/app/threeDispose.ts`**: Best-effort GPU cleanup helper for removed scenes/models; disposes geometries/materials/textures in an Object3D subtree.

### `src/landing/` (landing page effects)

- **`src/landing/parallax.ts`**: Implements landing background parallax:
  - Sets background images on `[data-parallax-layer]` elements using provided asset URLs.
  - Computes scroll progress (0..1) relative to the landing section.
  - Uses a spring integrator (stiffness/damping/mass) to smooth scroll progress (Framer Motion–like feel).
  - Drives per-layer transforms (mountains/planets) on each animation frame.
  - Returns a disposer to stop RAF and remove listeners.
- **`src/landing/flipWords.ts`**: Implements rotating “flip words” headline text:
  - Reads words from `data-flip-words="A,B,C"` and duration from `data-flip-duration`.
  - Builds DOM spans for letters with staggered animation delays.
  - Animates exit/enter by toggling CSS classes and timing removal after the exit duration.
  - Returns a disposer to clear timers.

### `src/models/` (3D models)

- **`src/models/SuperHornet.ts`**: Loads the DarkStar GLB model (despite the name):
  - Uses `GLTFLoader` from `three-stdlib`.
  - Resolves the asset URL using `baseUrl` (important for GitHub Pages base paths).
  - Loads either `assets/DarkStar.glb` or `assets/DarkStarSmall.glb` depending on `useSmall`.
  - Adds the model to the scene, scales it, and wires pointer rotation via `createPointerRotationController(...)`.
  - Returns `{ model, update, dispose }` (or `null` on error).

### `src/utils/`

- **`src/utils/mobileCheck.ts`**: `isMobile()` helper (simple user-agent regex).

### Type support / assets

- **`src/vite-env.d.ts`**: Vite TypeScript environment types reference.
- **`src/typescript.svg`**: Static asset (TypeScript logo) from the template.

## `public/` (static assets served as-is)

- **`public/assets/*.glb`**: 3D models used by the Three.js scene:
  - `DarkStar.glb`: main model.
  - `DarkStarSmall.glb`: smaller variant for mobile.
- **`public/assets/*.png|*.jpg|*.PNG`**: Landing/background images:
  - `intro_bg.PNG`: page background (set via `--site-bg`).
  - `sky.jpg`, `mountain-*.png`, `planets.png`: parallax layers.
- **`public/models/astronaut.glb`**: Additional model asset (currently not referenced by the TypeScript code shown here).
- **`public/vite.svg`**: Vite logo asset (template).


